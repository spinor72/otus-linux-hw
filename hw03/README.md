# ДЗ №3. Работа с LVM

## В процессе сделано
- создан `vagrantfile` для запуска виртуальной машины с несколькими дисками для создания LVM томов.
- изучены утилиты для работы с LVM 
  - `lvmdiskscan`, `pvcreate`, `vgcreate`, `lvcreate`, `lvdisplay`, `lvs`, `vgdisplay`, `vgs`,  `pvdisplay`, `vgextend`  `resize2fs`
- для ДЗ написаны скрипты
  - изменение размера корневого раздела с XFS
  - перенос `/var` на LVM-зеркало
  - перенос `/home` на отдельный LVM том и проверка снапшотов
  - (*) установка ZFS и перенос `/opt` на zfs пул с RAID и кэш, проверка снапшотов zfs

## Как запустить проект:

 - из папки `hw03` репозитория запустить виртуальную машину командой `vagrant up`
 
## Как проверить работоспособность:

- залогиниться в виртуальную машину командой `vagrant ssh otuslinux`
- запустить скрипт `sudo /vagrant/copy-root.sh`  для переноса содержимого корневого раздела на временный том, после завершения работы скрипта, перезагрузиться (`sudo reboot`)
- снова залогиниться и запустить скрипт `sudo /vagrant/resize-root.sh`, скрипт создаст раздел меньшего размера и перенесет содержимое с временного, затем переместит `/var` на созданное LVM-зеркало на 2х свободных дисках
- перезагрузить вирутальную машину, после логина можно увидеть, что теперь корневой раздел - 8Gb и папка `/var` монтируется с LVM-зеркала
- запустить скрипт `sudo /vagrant/make-opt.sh` , выполнится установка необходимых для работы файловой системы ZFS пакетов и модулей (процесс довольно длительный), затем на базе вирутального диска, использовавшегося для временного корневого раздела будет создан набор томов, на которых будет поднят ZFS-пул, с RAID и кэш, будет проверена работа снапшота в `zfs`
- запустить скрипт `sudo /vagrant/make-home.sh` , который переместит `/home` на отдельный LVM том.
- перезагрузиться, после логина можно убедиться с помощью команд `lsblk`, `zfs mount`,  `zpool status` что все монтируется как надо.


_После проверки можно удалить виртуальную машину командой `vagrant destroy`_
